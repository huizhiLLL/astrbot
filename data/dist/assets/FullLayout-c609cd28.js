import{u as de,c as te,r as Oe,o as m,a as b,w as t,b as a,V as Le,m as ke,d as Ie,e as u,t as i,f as e,g as M,F as De,h as Ue,n as ue,i as Je,j as Qe,k as Ve,l as L,p as C,q as Ze,s as ae,v as et,x as Ne,y as tt,z as h,A as r,B as at,C as g,D as ot,E as U,G as He,H as We,I as Se,J as lt,K as st,L as se,M as ve,N as ze,O as z,P as ge,Q as Pe,R as be,S as _e,T as nt,U as it,W as Me,X as rt,Y as Ee,Z as ne,_ as Re,$ as ie,a0 as $e,a1 as ye,a2 as we,a3 as dt,a4 as ut,a5 as P,a6 as Ae,a7 as ct,a8 as mt,a9 as pt,aa as ht,ab as ft}from"./index-77b120c5.js";import{useCustomizerStore as $}from"./customizer-13facaf4.js";import{s as re,a as xe,M as vt}from"./MigrationDialog-474503c1.js";import{_ as Xe}from"./_plugin-vue_export-helper-c27b6911.js";import{L as gt}from"./LanguageSwitcher-3999e8c5.js";import{m as Be}from"./md5-c69c0c74.js";import{u as bt}from"./common-6d6e5a4f.js";import{M as _t}from"./index-47e3efb7.js";import"./ConsoleDisplayer-dd1d5724.js";import"./WaitingForRestart-fc0333aa.js";const yt={__name:"NavItem",props:{item:Object,level:Number},setup(d){const D=d,{t:v}=de(),y=$(),o=te(()=>{const w=D.level??0;return{"--indent-padding":y.mini_sidebar?"0px":`${w*24}px`}});return(w,V)=>{const _=Oe("NavItem",!0);return d.item.children?(m(),b(Je,{key:0,value:d.item.title,class:ue({"group-bordered":e(y).mini_sidebar})},{activator:t(({props:A})=>[a(Le,ke(A,{rounded:"",class:"mb-1",color:"secondary","prepend-icon":d.item.icon,style:{"--indent-padding":"0px"}}),{default:t(()=>[a(Ie,{style:{"font-size":"14px","font-weight":"500","line-height":"1.2","word-break":"break-word"}},{default:t(()=>[u(i(e(v)(d.item.title)),1)]),_:1})]),_:2},1040,["prepend-icon"])]),default:t(()=>[(m(!0),M(De,null,Ue(d.item.children,(A,k)=>(m(),b(_,{key:k,item:A,level:(d.level||0)+1},null,8,["item","level"]))),128))]),_:1},8,["value","class"])):(m(),b(Le,{key:1,to:d.item.type==="external"?"":d.item.to,href:d.item.type==="external"?d.item.to:"",rounded:"",class:"mb-1",color:"secondary",disabled:d.item.disabled,target:d.item.type==="external"?"_blank":"",style:ae(o.value)},Qe({prepend:t(()=>[d.item.icon?(m(),b(L,{key:0,size:d.item.iconSize,class:"hide-menu",icon:d.item.icon},null,8,["size","icon"])):C("",!0)]),default:t(()=>[a(Ie,{style:{"font-size":"14px"}},{default:t(()=>[u(i(e(v)(d.item.title)),1)]),_:1}),d.item.subCaption?(m(),b(Ze,{key:0,class:"text-caption mt-n1 hide-menu"},{default:t(()=>[u(i(d.item.subCaption),1)]),_:1})):C("",!0)]),_:2},[d.item.chip?{name:"append",fn:t(()=>[a(Ve,{color:d.item.chipColor,class:"sidebarchip hide-menu",size:d.item.chipIcon?"small":"default",variant:d.item.chipVariant,"prepend-icon":d.item.chipIcon},{default:t(()=>[u(i(d.item.chip),1)]),_:1},8,["color","size","variant","prepend-icon"])]),key:"0"}:void 0]),1032,["to","href","disabled","target","style"]))}}};const wt=d=>(He("data-v-2bd5ed98"),d=d(),We(),d),xt={class:"sidebar-container"},kt={key:0,class:"sidebar-footer"},Dt={style:{display:"flex","align-items":"center"}},Vt={style:{"margin-left":"8px"}},St={style:{display:"flex",gap:"8px"}},Ct=wt(()=>r("iframe",{src:"https://astrbot.app",style:{width:"100%",height:"calc(100% - 56px)",border:"none","border-bottom-left-radius":"12px","border-bottom-right-radius":"12px"}},null,-1)),Tt=200,Lt=300,It={__name:"VerticalSidebar",setup(d){const{t:D}=de(),v=$(),y=et(re),o=p=>{p.key==="astrbot_sidebar_customization"&&(y.value=xe(re))},w=()=>{y.value=xe(re)};Ne(()=>{y.value=xe(re),window.addEventListener("storage",o),window.addEventListener("sidebar-customization-changed",w)}),tt(()=>{window.removeEventListener("storage",o),window.removeEventListener("sidebar-customization-changed",w)});const V=h(!1),_=h(null),A=h(235),k=h(!1),S=h({position:"fixed",bottom:"16px",right:"16px",width:"490px",height:"640px",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"10000000",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"});window.innerWidth<768&&(S.value={position:"fixed",top:"10%",left:"0%",width:"100%",height:"80%",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"1002",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"},v.Sidebar_drawer=!1);const N={width:"100%",padding:"8px",background:"#f0f0f0",borderBottom:"1px solid #ccc",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move"};function T(){V.value=!V.value}function X(p){if(typeof window<"u"){let c=p||"https://astrbot.app";window.open(c,"_blank")}}let q=0,F=0,B=!1;function G(p,c,x){return Math.min(Math.max(p,c),x)}function H(p,c){B=!0;const f=document.getElementById("draggable-iframe").getBoundingClientRect();q=p-f.left,F=c-f.top,document.body.style.userSelect="none",document.addEventListener("mousemove",O),document.addEventListener("mouseup",Y),document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",Q)}function K(p){H(p.clientX,p.clientY)}function O(p){B&&Z(p.clientX,p.clientY)}function Y(){I()}function J(p){if(p.touches.length===1){const c=p.touches[0];H(c.clientX,c.clientY)}}function E(p){if(B&&p.touches.length===1){p.preventDefault();const c=p.touches[0];Z(c.clientX,c.clientY)}}function Q(){I()}function Z(p,c){const x=document.getElementById("draggable-iframe"),f=G(p-q,0,window.innerWidth-x.offsetWidth),W=G(c-F,0,window.innerHeight-x.offsetHeight);S.value.left=f+"px",S.value.top=W+"px"}function I(){B=!1,document.body.style.userSelect="",document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",Y),document.removeEventListener("touchmove",E),document.removeEventListener("touchend",Q)}function ce(p){k.value=!0,document.body.style.userSelect="none",document.body.style.cursor="ew-resize";const c=p.clientX,x=A.value;function f(oe){if(!k.value)return;const pe=oe.clientX-c,le=Math.max(Tt,Math.min(Lt,x+pe));A.value=le}function W(){k.value=!1,document.body.style.userSelect="",document.body.style.cursor="",document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",W)}document.addEventListener("mousemove",f),document.addEventListener("mouseup",W)}function ee(p){return p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}async function me(){try{const c=await(await fetch("https://cloud.astrbot.app/api/v1/github/repo-info")).json();c.data&&c.data.stargazers_count&&(_.value=c.data.stargazers_count,console.debug("Fetched star count:",_.value))}catch(p){console.debug("Failed to fetch star count:",p)}}return me(),(p,c)=>(m(),M(De,null,[a(ot,{left:"",modelValue:e(v).Sidebar_drawer,"onUpdate:modelValue":c[1]||(c[1]=x=>e(v).Sidebar_drawer=x),elevation:"0","rail-width":"80",app:"",class:"leftSidebar",width:A.value,rail:e(v).mini_sidebar},{default:t(()=>[r("div",xt,[a(at,{class:"pa-4 listitem flex-grow-1"},{default:t(()=>[(m(!0),M(De,null,Ue(y.value,(x,f)=>(m(),b(yt,{key:f,item:x,class:"leftPadding"},null,8,["item"]))),128))]),_:1}),e(v).mini_sidebar?C("",!0):(m(),M("div",kt,[a(g,{style:{"margin-bottom":"8px"},size:"small",variant:"tonal",color:"primary",to:"/settings"},{default:t(()=>[u(" ðŸ”§ "+i(e(D)("core.navigation.settings")),1)]),_:1}),a(g,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:T},{default:t(()=>[u(i(e(D)("core.navigation.documentation")),1)]),_:1}),a(g,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:c[0]||(c[0]=x=>X("https://github.com/AstrBotDevs/AstrBot"))},{default:t(()=>[u(i(e(D)("core.navigation.github"))+" ",1),_.value?(m(),b(Ve,{key:0,size:"x-small",variant:"outlined",class:"ml-2",style:{"font-weight":"normal"}},{default:t(()=>[u(i(ee(_.value)),1)]),_:1})):C("",!0)]),_:1})]))]),!e(v).mini_sidebar&&e(v).Sidebar_drawer?(m(),M("div",{key:0,class:ue(["sidebar-resize-handle",{resizing:k.value}]),onMousedown:ce},null,34)):C("",!0)]),_:1},8,["modelValue","width","rail"]),V.value?(m(),M("div",{key:0,id:"draggable-iframe",style:ae(S.value)},[r("div",{style:N,onMousedown:K,onTouchstart:J},[r("div",Dt,[a(L,{icon:"mdi-cursor-move"}),r("span",Vt,i(e(D)("core.navigation.drag")),1)]),r("div",St,[a(g,{icon:"",onClick:c[2]||(c[2]=U(x=>X("https://astrbot.app"),["stop"])),onMousedown:c[3]||(c[3]=U(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:t(()=>[a(L,{icon:"mdi-open-in-new"})]),_:1}),a(g,{icon:"",onClick:U(T,["stop"]),onMousedown:c[4]||(c[4]=U(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:t(()=>[a(L,{icon:"mdi-close"})]),_:1},8,["onClick"])])],32),Ct],4)):C("",!0)],64))}},zt=Xe(It,[["__scopeId","data-v-2bd5ed98"]]),Mt="/assets/astrbot_logo_mini-93eefda2.webp",Et=d=>(He("data-v-861661f1"),d=d(),We(),d),Rt={class:"logo-container"},$t={class:"logo-content"},At=Et(()=>r("div",{class:"logo-image"},[r("img",{width:"110",src:Mt,alt:"AstrBot Logo"})],-1)),Bt={class:"logo-text"},Ut=["innerHTML"],Nt=Se({__name:"Logo",props:{title:{default:""},subtitle:{default:""}},setup(d){const{t:D}=de(),v=y=>y.includes("AstrBot ")||y.includes("AstrBot")?y.replace(/(AstrBot)\s+(.+)/,"$1<wbr> $2"):y;return(y,o)=>(m(),M("div",Rt,[r("div",$t,[At,r("div",Bt,[r("h2",{style:ae({color:e($)().uiTheme==="PurpleTheme"?"#5e35b1":"#d7c5fa"}),innerHTML:v(y.title||e(D)("core.header.logoTitle"))},null,12,Ut),r("h4",{style:ae({color:e($)().uiTheme==="PurpleTheme"?"#000000aa":"#ffffffcc"}),class:"hint-text"},i(y.subtitle||e(D)("core.header.accountDialog.title")),5)])])]))}});const Ht=Xe(Nt,[["__scopeId","data-v-861661f1"]]),Wt=r("span",{class:"logo-text"},[u("Astr"),r("span",{class:"logo-text-light"},"Bot")],-1),Pt={class:"version-text hidden-xs"},Xt={class:"mr-4 hidden-xs"},Ft={key:0},Yt={key:1},jt={class:"text-h5"},qt={style:{display:"inline-block"}},Gt={style:{"margin-left":"4px"}},Kt=["innerHTML"],Ot={class:"mb-4 mt-4"},Jt={class:"mb-4"},Qt={href:"https://containrrr.dev/watchtower/usage-overview/"},Zt={class:"text-body-2"},ea=r("br",null,null,-1),ta={href:"https://github.com/AstrBotDevs/AstrBot/issues",target:"_blank",class:"text-decoration-none"},aa={class:"d-flex align-center"},oa={style:{"margin-top":"16px"}},la={class:"mb-4"},sa={class:"mb-4"},na=r("br",null,null,-1),ia={href:"https://github.com/AstrBotDevs/AstrBot/commits/master"},ra={style:{"margin-top":"16px"}},da={class:"mb-4"},ua={class:"mb-4"},ca=r("br",null,null,-1),ma={class:"mb-4"},pa={key:0},ha={key:1},fa={class:"d-flex flex-column align-center mb-6"},va={class:"text-caption text-medium-emphasis mt-2"},ga=Se({__name:"VerticalHeader",setup(d){const D=new _t({html:!0,breaks:!0,linkify:!0,typographer:!1}),v=$(),y=lt(),{t:o}=de();let w=h(!1),V=h(!1),_=h(!1);const A=localStorage.getItem("user");let k=h(""),S=h(""),N=h("");h("");let T=h(""),X=h(""),q=h(!1),F=h(""),B=h(!1),G=h(""),H=h(""),K=h([]),O=h([]),Y=h(!1),J=h(!1),E=h(!1),Q=h(""),Z=h(""),I=h(0);const ce=te(()=>[{title:o("core.header.updateDialog.table.tag"),key:"tag_name"},{title:o("core.header.updateDialog.table.publishDate"),key:"published_at"},{title:o("core.header.updateDialog.table.content"),key:"body"},{title:o("core.header.updateDialog.table.sourceUrl"),key:"zipball_url"},{title:o("core.header.updateDialog.table.actions"),key:"switch"}]),ee=h(!0),me=te(()=>[n=>!!n||o("core.header.accountDialog.validation.passwordRequired"),n=>n.length>=8||o("core.header.accountDialog.validation.passwordMinLength")]),p=te(()=>[n=>!n||n.length>=3||o("core.header.accountDialog.validation.usernameMinLength")]),c=h(!1),x=h(!1),f=h({loading:!1,success:!1,error:!1,message:""}),W=n=>{const l=["alpha","beta","rc","pre","preview","dev"],s=n.toLowerCase();return l.some(R=>s.includes(R))};function oe(){f.value.loading=!0,f.value.error=!1,f.value.success=!1,k.value!=""&&(k.value=Be.md5(k.value)),S.value!=""&&(S.value=Be.md5(S.value)),P.post("/api/auth/account/edit",{password:k.value,new_password:S.value,new_username:N.value?N.value:A}).then(n=>{if(n.data.status=="error"){f.value.error=!0,f.value.message=n.data.message,k.value="",S.value="";return}f.value.success=!0,f.value.message=n.data.message,setTimeout(()=>{w.value=!w.value,Ae().logout()},2e3)}).catch(n=>{console.log(n),f.value.error=!0,f.value.message=typeof n=="string"?n:o("core.header.accountDialog.messages.updateFailed"),k.value="",S.value=""}).finally(()=>{f.value.loading=!1})}function pe(){P.get("/api/stat/version").then(n=>{var s,R;F.value="v"+n.data.data.version,G.value=(s=n.data.data)==null?void 0:s.dashboard_version,((R=n.data.data)==null?void 0:R.change_pwd_hint)?(w.value=!0,V.value=!0,localStorage.setItem("change_pwd_hint","true")):localStorage.removeItem("change_pwd_hint")}).catch(n=>{console.log(n)})}function le(){T.value=o("core.header.updateDialog.status.checking"),P.get("/api/update/check").then(n=>{q.value=n.data.data.has_new_version,n.data.data.has_new_version?(X.value=n.data.message,T.value=o("core.header.version.hasNewVersion")):T.value=n.data.message,B.value=n.data.data.dashboard_has_new_version}).catch(n=>{if(n.response&&n.response.status==401){console.log("401"),Ae().logout();return}console.log(n),T.value=n})}function Fe(){P.get("/api/update/releases").then(n=>{K.value=n.data.data.map(l=>(l.published_at=new Date(l.published_at).toLocaleString(),l))}).catch(n=>{console.log(n)})}function Ye(){let n=localStorage.getItem("selectedGitHubProxy")||"";const l="https://api.github.com/repos/AstrBotDevs/AstrBot/commits";let s=l;n!==""&&(n=n.endsWith("/")?n:n+"/",s=n+l);function R(Ke,Te){fetch(Ke,{headers:{Host:"api.github.com",Referer:"https://api.github.com"}}).then(j=>j.json()).then(j=>{O.value=Array.isArray(j)?j.map(fe=>({sha:fe.sha,date:new Date(fe.commit.author.date).toLocaleString(),message:fe.commit.message})):[]}).catch(j=>{Te?Te():console.log("èŽ·å–å¼€å‘ç‰ˆæäº¤ä¿¡æ¯å¤±è´¥:",j)})}R(s,()=>{n!==""&&s!==l&&(console.log("ä½¿ç”¨ä»£ç†è¯·æ±‚å¤±è´¥ï¼Œå°è¯•ç›´æŽ¥è¯·æ±‚"),R(l))})}function he(n){T.value=o("core.header.updateDialog.status.switching"),J.value=!0,P.post("/api/update/do",{version:n,proxy:localStorage.getItem("selectedGitHubProxy")||""}).then(l=>{T.value=l.data.message,l.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(l=>{console.log(l),T.value=l}).finally(()=>{J.value=!1})}function je(){Y.value=!0,T.value=o("core.header.updateDialog.status.updating"),P.post("/api/update/dashboard").then(n=>{T.value=n.data.message,n.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{console.log(n),T.value=n}).finally(()=>{Y.value=!1})}function qe(){const n=v.uiTheme==="PurpleThemeDark"?"PurpleTheme":"PurpleThemeDark";v.SET_UI_THEME(n),y.global.name.value=n}function Ge(n,l){Q.value=n,Z.value=l,E.value=!0}pe(),le();const Ce=bt();return Ce.createEventSource(),Ce.getStartTime(),(n,l)=>(m(),b(ut,{elevation:"0",height:"55"},{default:t(()=>[e($)().uiTheme==="PurpleTheme"?(m(),b(g,{key:0,style:{"margin-left":"22px"},class:"hidden-md-and-down text-secondary",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:l[0]||(l[0]=U(s=>e(v).SET_MINI_SIDEBAR(!e(v).mini_sidebar),["stop"])),size:"small"},{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-menu")]),_:1})]),_:1})):(m(),b(g,{key:1,style:{"margin-left":"22px",color:"var(--v-theme-primaryText)","background-color":"var(--v-theme-secondary)"},class:"hidden-md-and-down",icon:"",rounded:"sm",variant:"flat",onClick:l[1]||(l[1]=U(s=>e(v).SET_MINI_SIDEBAR(!e(v).mini_sidebar),["stop"])),size:"small"},{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-menu")]),_:1})]),_:1})),e($)().uiTheme==="PurpleTheme"?(m(),b(g,{key:2,class:"hidden-lg-and-up ms-3",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:U(e(v).SET_SIDEBAR_DRAWER,["stop"]),size:"small"},{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-menu")]),_:1})]),_:1},8,["onClick"])):(m(),b(g,{key:3,class:"hidden-lg-and-up ms-3",icon:"",rounded:"sm",variant:"flat",onClick:U(e(v).SET_SIDEBAR_DRAWER,["stop"]),size:"small"},{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-menu")]),_:1})]),_:1},8,["onClick"])),r("div",{class:ue(["logo-container",{"mobile-logo":n.$vuetify.display.xs}]),onClick:l[2]||(l[2]=s=>e(st).push("/about"))},[Wt,r("span",Pt,i(e(F)),1)],2),a(se),r("div",Xt,[e(q)?(m(),M("small",Ft,i(e(o)("core.header.version.hasNewVersion")),1)):e(B)?(m(),M("small",Yt,i(e(o)("core.header.version.dashboardHasNewVersion")),1)):C("",!0)]),a(gt,{variant:"header"}),a(g,{size:"small",onClick:l[3]||(l[3]=s=>{qe()}),class:"action-btn",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm",icon:""},{default:t(()=>[e($)().uiTheme==="PurpleThemeDark"?(m(),b(L,{key:0},{default:t(()=>[u("mdi-weather-night")]),_:1})):(m(),b(L,{key:1},{default:t(()=>[u("mdi-white-balance-sunny")]),_:1}))]),_:1}),a(we,{modelValue:e(_),"onUpdate:modelValue":l[12]||(l[12]=s=>z(_)?_.value=s:_=s),width:n.$vuetify.display.smAndDown?"100%":"1200",fullscreen:n.$vuetify.display.xs},{activator:t(({props:s})=>[a(g,ke({size:"small",onClick:l[4]||(l[4]=R=>{le(),Fe(),Ye()}),class:"action-btn",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm"},s,{icon:""}),{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-arrow-up-circle")]),_:1})]),_:2},1040)]),default:t(()=>[a(ve,null,{default:t(()=>[a(ze,{class:"mobile-card-title"},{default:t(()=>[r("span",jt,i(e(o)("core.header.updateDialog.title")),1),n.$vuetify.display.xs?(m(),b(g,{key:0,icon:"",onClick:l[5]||(l[5]=s=>z(_)?_.value=!1:_=!1)},{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-close")]),_:1})]),_:1})):C("",!0)]),_:1}),a(ge,null,{default:t(()=>[a(Pe,null,{default:t(()=>[be(a(nt,{class:"mb-4",indeterminate:"",color:"primary"},null,512),[[_e,e(J)]]),r("div",null,[r("h1",qt,i(e(F)),1),r("small",Gt,i(e(T)),1)]),e(X)?(m(),M("div",{key:0,style:{"background-color":"#646cff24",padding:"16px","border-radius":"10px","font-size":"14px","max-height":"400px","overflow-y":"auto"},innerHTML:e(D).render(e(X)),class:"markdown-content"},null,8,Kt)):C("",!0),r("div",Ot,[r("small",null,i(e(o)("core.header.updateDialog.tip"))+" "+i(e(o)("core.header.updateDialog.tipContinue")),1)]),a(it,{modelValue:e(I),"onUpdate:modelValue":l[6]||(l[6]=s=>z(I)?I.value=s:I=s)},{default:t(()=>[a(Me,{value:"0"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.tabs.release")),1)]),_:1}),a(Me,{value:"1"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.tabs.dev")),1)]),_:1})]),_:1},8,["modelValue"]),a(rt,{modelValue:e(I),"onUpdate:modelValue":l[7]||(l[7]=s=>z(I)?I.value=s:I=s)},{default:t(()=>[be(a(Ee,{key:"0"},{default:t(()=>[r("div",Jt,[r("small",null,[u(i(e(o)("core.header.updateDialog.dockerTip"))+" ",1),r("a",Qt,i(e(o)("core.header.updateDialog.dockerTipLink")),1),u(" "+i(e(o)("core.header.updateDialog.dockerTipContinue")),1)])]),e(K).some(s=>W(s.tag_name))?(m(),b(ne,{key:0,type:"warning",variant:"tonal",border:"start"},{prepend:t(()=>[a(L,null,{default:t(()=>[u("mdi-alert-circle-outline")]),_:1})]),default:t(()=>[r("div",Zt,[r("strong",null,i(e(o)("core.header.updateDialog.preReleaseWarning.title")),1),ea,u(" "+i(e(o)("core.header.updateDialog.preReleaseWarning.description"))+" ",1),r("a",ta,i(e(o)("core.header.updateDialog.preReleaseWarning.issueLink")),1)])]),_:1})):C("",!0),a(Re,{headers:ce.value,items:e(K),"item-key":"name","items-per-page":5},{"item.tag_name":t(({item:s})=>[r("div",aa,[r("span",null,i(s.tag_name),1),W(s.tag_name)?(m(),b(Ve,{key:0,size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.preRelease")),1)]),_:1})):C("",!0)])]),"item.body":t(({item:s})=>[a(g,{onClick:R=>Ge(s.body,s.tag_name),rounded:"xl",variant:"tonal",color:"primary",size:"x-small"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.table.view")),1)]),_:2},1032,["onClick"])]),"item.switch":t(({item:s})=>[a(g,{onClick:R=>he(s.tag_name),rounded:"xl",variant:"plain",color:"primary"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.table.switch")),1)]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1},512),[[_e,e(I)==0]]),be(a(Ee,{key:"1"},{default:t(()=>[r("div",oa,[a(Re,{headers:[{title:e(o)("core.header.updateDialog.table.sha"),key:"sha"},{title:e(o)("core.header.updateDialog.table.date"),key:"date"},{title:e(o)("core.header.updateDialog.table.message"),key:"message"},{title:e(o)("core.header.updateDialog.table.actions"),key:"switch"}],items:e(O),"item-key":"sha"},{"item.switch":t(({item:s})=>[a(g,{onClick:R=>he(s.sha),rounded:"xl",variant:"plain",color:"primary"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.table.switch")),1)]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])])]),_:1},512),[[_e,e(I)==1]])]),_:1},8,["modelValue"]),r("h3",la,i(e(o)("core.header.updateDialog.manualInput.title")),1),a(ie,{label:e(o)("core.header.updateDialog.manualInput.placeholder"),modelValue:e(H),"onUpdate:modelValue":l[8]||(l[8]=s=>z(H)?H.value=s:H=s),required:"",variant:"outlined"},null,8,["label","modelValue"]),r("div",sa,[r("small",null,i(e(o)("core.header.updateDialog.manualInput.hint")),1),na,r("a",ia,[r("small",null,i(e(o)("core.header.updateDialog.manualInput.linkText")),1)])]),a(g,{color:"error",style:{"border-radius":"10px"},onClick:l[9]||(l[9]=s=>he(e(H)))},{default:t(()=>[u(i(e(o)("core.header.updateDialog.manualInput.confirm")),1)]),_:1}),a($e,{class:"mt-4 mb-4"}),r("div",ra,[r("h3",da,i(e(o)("core.header.updateDialog.dashboardUpdate.title")),1),r("div",ua,[r("small",null,i(e(o)("core.header.updateDialog.dashboardUpdate.currentVersion"))+" "+i(e(G)),1),ca]),r("div",ma,[e(B)?(m(),M("p",pa,i(e(o)("core.header.updateDialog.dashboardUpdate.hasNewVersion")),1)):(m(),M("p",ha,i(e(o)("core.header.updateDialog.dashboardUpdate.isLatest")),1))]),a(g,{color:"primary",style:{"border-radius":"10px"},onClick:l[10]||(l[10]=s=>je()),disabled:!e(B),loading:e(Y)},{default:t(()=>[u(i(e(o)("core.header.updateDialog.dashboardUpdate.downloadAndUpdate")),1)]),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),a(ye,null,{default:t(()=>[a(se),a(g,{color:"blue-darken-1",variant:"text",onClick:l[11]||(l[11]=s=>z(_)?_.value=!1:_=!1)},{default:t(()=>[u(i(e(o)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width","fullscreen"]),a(we,{modelValue:e(E),"onUpdate:modelValue":l[14]||(l[14]=s=>z(E)?E.value=s:E=s),"max-width":"800"},{default:t(()=>[a(ve,null,{default:t(()=>[a(ze,{class:"text-h5"},{default:t(()=>[u(i(e(o)("core.header.updateDialog.releaseNotes.title"))+": "+i(e(Z)),1)]),_:1}),a(ge,{style:{"font-size":"14px","max-height":"400px","overflow-y":"auto"},innerHTML:e(D).render(e(Q)),class:"markdown-content"},null,8,["innerHTML"]),a(ye,null,{default:t(()=>[a(se),a(g,{color:"blue-darken-1",variant:"text",onClick:l[13]||(l[13]=s=>z(E)?E.value=!1:E=!1)},{default:t(()=>[u(i(e(o)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(we,{modelValue:e(w),"onUpdate:modelValue":l[22]||(l[22]=s=>z(w)?w.value=s:w=s),persistent:"","max-width":n.$vuetify.display.xs?"90%":"500"},{activator:t(({props:s})=>[a(g,ke({size:"small",class:"action-btn mr-4",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm"},s,{icon:""}),{default:t(()=>[a(L,null,{default:t(()=>[u("mdi-account")]),_:1})]),_:2},1040)]),default:t(()=>[a(ve,{class:"account-dialog"},{default:t(()=>[a(ge,{class:"py-6"},{default:t(()=>[r("div",fa,[a(Ht,{title:e(o)("core.header.logoTitle"),subtitle:e(o)("core.header.accountDialog.title")},null,8,["title","subtitle"])]),e(V)?(m(),b(ne,{key:0,type:"warning",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[r("strong",null,i(e(o)("core.header.accountDialog.securityWarning")),1)]),_:1})):C("",!0),f.value.success?(m(),b(ne,{key:1,type:"success",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[u(i(f.value.message),1)]),_:1})):C("",!0),f.value.error?(m(),b(ne,{key:2,type:"error",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[u(i(f.value.message),1)]),_:1})):C("",!0),a(dt,{modelValue:ee.value,"onUpdate:modelValue":l[20]||(l[20]=s=>ee.value=s),onSubmit:U(oe,["prevent"])},{default:t(()=>[a(ie,{modelValue:e(k),"onUpdate:modelValue":l[15]||(l[15]=s=>z(k)?k.value=s:k=s),"append-inner-icon":c.value?"mdi-eye-off":"mdi-eye",type:c.value?"text":"password",label:e(o)("core.header.accountDialog.form.currentPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":l[16]||(l[16]=s=>c.value=!c.value),"prepend-inner-icon":"mdi-lock-outline","hide-details":"auto",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","label"]),a(ie,{modelValue:e(S),"onUpdate:modelValue":l[17]||(l[17]=s=>z(S)?S.value=s:S=s),"append-inner-icon":x.value?"mdi-eye-off":"mdi-eye",type:x.value?"text":"password",rules:me.value,label:e(o)("core.header.accountDialog.form.newPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":l[18]||(l[18]=s=>x.value=!x.value),"prepend-inner-icon":"mdi-lock-plus-outline",hint:e(o)("core.header.accountDialog.form.passwordHint"),"persistent-hint":"",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","rules","label","hint"]),a(ie,{modelValue:e(N),"onUpdate:modelValue":l[19]||(l[19]=s=>z(N)?N.value=s:N=s),rules:p.value,label:e(o)("core.header.accountDialog.form.newUsername"),variant:"outlined",clearable:"","prepend-inner-icon":"mdi-account-edit-outline",hint:e(o)("core.header.accountDialog.form.usernameHint"),"persistent-hint":"",class:"mb-3"},null,8,["modelValue","rules","label","hint"])]),_:1},8,["modelValue","onSubmit"]),r("div",va,i(e(o)("core.header.accountDialog.form.defaultCredentials")),1)]),_:1}),a($e),a(ye,{class:"pa-4"},{default:t(()=>[a(se),e(V)?C("",!0):(m(),b(g,{key:0,variant:"tonal",color:"secondary",onClick:l[21]||(l[21]=s=>z(w)?w.value=!1:w=!1),disabled:f.value.loading},{default:t(()=>[u(i(e(o)("core.header.accountDialog.actions.cancel")),1)]),_:1},8,["disabled"])),a(g,{color:"primary",onClick:oe,loading:f.value.loading,disabled:!ee.value,"prepend-icon":"mdi-content-save"},{default:t(()=>[u(i(e(o)("core.header.accountDialog.actions.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"])]),_:1}))}});const ba={style:{height:"100%"}},La=Se({__name:"FullLayout",setup(d){const D=$(),v=ct(),y=te(()=>v.path.startsWith("/chat")),o=h(null),w=async()=>{try{const V=await P.get("/api/stat/version");if(V.data.status==="ok"&&V.data.data.need_migration&&o.value&&typeof o.value.open=="function"){const _=await o.value.open();_.success&&(console.log("Migration completed successfully:",_.message),window.location.reload())}}catch(V){console.error("Failed to check migration status:",V)}};return Ne(()=>{setTimeout(w,1e3)}),(V,_)=>(m(),b(ft,null,{default:t(()=>[a(ht,{theme:e($)().uiTheme,class:ue([e(D).fontTheme,e(D).mini_sidebar?"mini-sidebar":"",e(D).inputBg?"inputWithbg":""])},{default:t(()=>[a(ga),a(zt),a(mt,null,{default:t(()=>[a(Pe,{fluid:"",class:"page-wrapper",style:ae({height:"calc(100% - 8px)",padding:y.value?"0":void 0})},{default:t(()=>[r("div",ba,[a(e(pt))])]),_:1},8,["style"])]),_:1}),a(vt,{ref_key:"migrationDialog",ref:o},null,512)]),_:1},8,["theme","class"])]),_:1}))}});export{La as default};
