import{I as de,z as u,ao as Se,o as C,a as ne,w as a,b as e,N as W,e as s,P as G,$ as A,a1 as ie,L as ee,C as M,M as E,a2 as ce,A as r,a5 as N,ac as ve,aU as aa,c as la,x as ge,y as ta,g as P,t as o,f as i,_ as sa,l as D,p as H,T as Ue,a0 as j,U as Ie,W as le,b2 as oa,ay as De,az as te,n as na,E as $e,F as Fe,h as Pe,Z as oe,al as Q,am as T,aJ as Te,ad as fe,ak as me,G as Me,H as Ke,b3 as ia,aN as da,aL as ra,ai as Le,k as ae,a3 as ua,a7 as ca,B as Ce,V as Z,d as X,q as Y}from"./index-77b120c5.js";import{_ as _e}from"./_plugin-vue_export-helper-c27b6911.js";const va=r("p",{class:"mb-4 text-body-2 text-medium-emphasis"},[s(" ä¸ºäº†ä½¿ç”¨åŸºäºŽç½‘é¡µçš„çŸ¥è¯†åº“åŠŸèƒ½ï¼Œéœ€è¦æä¾› Tavily API Keyã€‚æ‚¨å¯ä»¥ä»Ž "),r("a",{href:"https://tavily.com/",target:"_blank"},"Tavily å®˜ç½‘"),s(" èŽ·å–ã€‚ ")],-1),ma=de({__name:"TavilyKeyDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(L,{emit:x}){const m=L,d=u(m.modelValue),S=u(""),I=u(!1),c=u("");Se(()=>m.modelValue,$=>{d.value=$,$&&(S.value="",c.value="",I.value=!1)});const U=()=>{x("update:modelValue",!1)},V=async()=>{var $,k;if(!S.value.trim()){c.value="API Key ä¸èƒ½ä¸ºç©º";return}c.value="",I.value=!0;try{const f=await N.get("/api/config/abconf",{params:{id:"default"}});if(f.data.status!=="ok")throw new Error("èŽ·å–å½“å‰é…ç½®å¤±è´¥");const _=f.data.data.config;_.provider_settings||(_.provider_settings={}),_.provider_settings.websearch_tavily_key=[S.value.trim()],_.provider_settings.websearch_provider="tavily";const F=await N.post("/api/config/astrbot/update",{conf_id:"default",config:_});F.data.status==="ok"?(x("success"),U()):c.value=F.data.message||"ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ Key æ˜¯å¦æ­£ç¡®"}catch(f){c.value=((k=($=f.response)==null?void 0:$.data)==null?void 0:k.message)||"ä¿å­˜å¤±è´¥ï¼Œå‘ç”ŸæœªçŸ¥é”™è¯¯"}finally{I.value=!1}};return($,k)=>(C(),ne(ce,{modelValue:d.value,"onUpdate:modelValue":k[1]||(k[1]=f=>d.value=f),"max-width":"500px",persistent:""},{default:a(()=>[e(E,null,{default:a(()=>[e(W,{class:"text-h5"},{default:a(()=>[s(" é…ç½® Tavily API Key ")]),_:1}),e(G,null,{default:a(()=>[va,e(A,{modelValue:S.value,"onUpdate:modelValue":k[0]||(k[0]=f=>S.value=f),label:"Tavily API Key",variant:"outlined",loading:I.value,"error-messages":c.value,autofocus:"",clearable:"",placeholder:"tvly-..."},null,8,["modelValue","loading","error-messages"])]),_:1}),e(ie,null,{default:a(()=>[e(ee),e(M,{variant:"text",onClick:U,disabled:I.value},{default:a(()=>[s(" å–æ¶ˆ ")]),_:1},8,["disabled"]),e(M,{color:"primary",variant:"elevated",onClick:V,loading:I.value},{default:a(()=>[s(" ä¿å­˜ ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),_a=L=>(Me("data-v-aaf7fd1a"),L=L(),Ke(),L),pa={class:"documents-tab"},fa={class:"action-bar mb-4"},ga={class:"d-flex align-center gap-2"},ba={class:"flex-grow-1",style:{padding:"4px 0px"}},ha={class:"font-weight-medium"},ka={key:0,class:"mt-1"},ya={class:"text-caption text-medium-emphasis mb-1"},xa={key:0},Va={class:"text-center py-8"},wa={class:"mt-4 text-medium-emphasis"},za={class:"text-h5"},$a=["onDrop"],Ca={class:"mt-4 text-h6"},Sa={class:"text-caption text-medium-emphasis mt-2"},Ua={class:"text-caption text-medium-emphasis"},Ia=_a(()=>r("p",{class:"text-caption text-medium-emphasis"},"æœ€å¤šå¯ä¸Šä¼  10 ä¸ªæ–‡ä»¶",-1)),Da={key:0,class:"mt-4"},Fa={class:"d-flex align-center justify-space-between mb-2"},Pa={class:"text-subtitle-2"},Ta={class:"files-list"},Ma={class:"d-flex align-center justify-space-between"},Ka={class:"d-flex align-center gap-2"},La={class:"font-weight-medium"},Ra={class:"text-caption"},Ba={key:0,class:"mb-4"},Aa={class:"d-flex align-center justify-space-between"},Na={key:0,class:"mt-6"},Ea={class:"d-flex align-center mb-4"},ja={class:"text-h6"},qa={class:"mt-6"},Ha={class:"d-flex align-center mb-4"},Oa={class:"text-h6"},Wa={class:"mt-2"},Ga={class:"text-h6 mb-4"},Qa=de({__name:"DocumentsTab",props:{kbId:{},kb:{}},emits:["refresh"],setup(L,{emit:x}){const m=L,{tm:d}=ve("features/knowledge-base/detail"),S=aa(),I=u(!1),c=u(!1),U=u(!1),V=u([]),$=u(""),k=u(!1),f=u(!1),_=u([]),F=u(null),p=u(!1),R=u(null),w=u("file"),O=u(""),re=u([]);u(new Map);const J=u(null),b=u("loading"),h=u(!1),y=u({show:!1,text:"",color:"success"}),K=(n,t="success")=>{y.value.text=n,y.value.color=t,y.value.show=!0},g=u({chunk_size:null,chunk_overlap:null,batch_size:32,tasks_limit:3,max_retries:3,enable_cleaning:!1,cleaning_provider_id:null}),he=()=>{var n,t;g.value={chunk_size:((n=m.kb)==null?void 0:n.chunk_size)||null,chunk_overlap:((t=m.kb)==null?void 0:t.chunk_overlap)||null,batch_size:32,tasks_limit:3,max_retries:3,enable_cleaning:!1,cleaning_provider_id:null}},Re=la(()=>c.value?!0:w.value==="file"?_.value.length===0:w.value==="url"?!!(!O.value||g.value.enable_cleaning&&!g.value.cleaning_provider_id):!0),Be=[{title:d("documents.name"),key:"doc_name",sortable:!0},{title:d("documents.type"),key:"file_type",sortable:!0},{title:d("documents.size"),key:"file_size",sortable:!0},{title:d("documents.chunks"),key:"chunk_count",sortable:!0},{title:d("documents.createdAt"),key:"created_at",sortable:!0},{title:d("documents.actions"),key:"actions",sortable:!1,align:"end"}],pe=async()=>{I.value=!0;try{const n=await N.get("/api/kb/document/list",{params:{kb_id:m.kbId}});n.data.status==="ok"&&(V.value=n.data.data.items||[])}catch(n){console.error("Failed to load documents:",n),K("åŠ è½½æ–‡æ¡£åˆ—è¡¨å¤±è´¥","error")}finally{I.value=!1}},Ae=n=>{const t=n.target;if(t.files&&t.files.length>0){const l=Array.from(t.files);ke(l)}},ke=n=>{if(_.value.length+n.length>10){K("æœ€å¤šåªèƒ½é€‰æ‹© 10 ä¸ªæ–‡ä»¶","warning");return}_.value.push(...n)},Ne=n=>{_.value.splice(n,1)},Ee=n=>{var t;if(p.value=!1,(t=n.dataTransfer)!=null&&t.files&&n.dataTransfer.files.length>0){const l=Array.from(n.dataTransfer.files);ke(l)}},je=async()=>{w.value==="file"?await qe():w.value==="url"&&await He()},qe=async()=>{if(_.value.length===0){K(d("upload.fileRequired"),"warning");return}c.value=!0;try{const n=new FormData;_.value.forEach((l,v)=>{n.append(`file${v}`,l)}),n.append("kb_id",m.kbId),g.value.chunk_size&&n.append("chunk_size",g.value.chunk_size.toString()),g.value.chunk_overlap&&n.append("chunk_overlap",g.value.chunk_overlap.toString()),n.append("batch_size",g.value.batch_size.toString()),n.append("tasks_limit",g.value.tasks_limit.toString()),n.append("max_retries",g.value.max_retries.toString());const t=await N.post("/api/kb/document/upload",n,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.status==="ok"){const l=t.data.data,v=l.task_id;K(`æ­£åœ¨åŽå°ä¸Šä¼  ${l.file_count} ä¸ªæ–‡ä»¶...`,"info");const z=_.value.map((B,q)=>({doc_id:`uploading_${v}_${q}`,doc_name:B.name,file_type:B.name.split(".").pop()||"",file_size:B.size,chunk_count:0,created_at:new Date().toISOString(),uploading:!0,taskId:v,uploadProgress:{stage:"waiting",current:0,total:100}}));V.value=[...z,...V.value],ue(),v&&ye(v)}else K(t.data.message||d("documents.uploadFailed"),"error")}catch(n){console.error("Failed to upload document:",n),K(d("documents.uploadFailed"),"error")}finally{c.value=!1}},He=async()=>{var n,t;if(!O.value){K(d("upload.urlRequired"),"warning");return}c.value=!0;try{const l={kb_id:m.kbId,url:O.value,batch_size:g.value.batch_size,tasks_limit:g.value.tasks_limit,max_retries:g.value.max_retries};g.value.chunk_size&&(l.chunk_size=g.value.chunk_size),g.value.chunk_overlap&&(l.chunk_overlap=g.value.chunk_overlap),g.value.enable_cleaning&&(l.enable_cleaning=!0,g.value.cleaning_provider_id&&(l.cleaning_provider_id=g.value.cleaning_provider_id));const v=await N.post("/api/kb/document/upload/url",l);if(v.data.status==="ok"){const z=v.data.data,B=z.task_id;K("æ­£åœ¨ä»Ž URL åŽå°æå–å†…å®¹...","info");const q={doc_id:`uploading_${B}_0`,doc_name:z.url,file_type:"url",file_size:0,chunk_count:0,created_at:new Date().toISOString(),uploading:!0,taskId:B,uploadProgress:{stage:"waiting",current:0,total:100}};V.value=[q,...V.value],ue(),B&&ye(B)}else K(v.data.message||d("documents.uploadFailed"),"error")}catch(l){console.error("Failed to upload from URL:",l);const v=((t=(n=l.response)==null?void 0:n.data)==null?void 0:t.message)||d("documents.uploadFailed");K(v,"error")}finally{c.value=!1}},ye=n=>{J.value&&se(),J.value=window.setInterval(async()=>{try{const t=await N.get("/api/kb/document/upload/progress",{params:{task_id:n}});if(t.data.status==="ok"){const l=t.data.data,v=l.status;if(v==="processing"&&l.progress){const z=l.progress,B=z.file_index||0;V.value=V.value.map(q=>q.taskId===n&&parseInt(q.doc_id.split("_").pop()||"0")===B?{...q,uploadProgress:{stage:z.stage||"waiting",current:z.current||0,total:z.total||100}}:q)}else if(v==="completed"){se();const z=l.result,B=(z==null?void 0:z.success_count)||0,q=(z==null?void 0:z.failed_count)||0;V.value=V.value.filter(ze=>ze.taskId!==n),await pe(),x("refresh"),q===0?K(`æˆåŠŸä¸Šä¼  ${B} ä¸ªæ–‡æ¡£`):K(`ä¸Šä¼ å®Œæˆ: ${B} ä¸ªæˆåŠŸ, ${q} ä¸ªå¤±è´¥`,"warning")}else v==="failed"&&(se(),V.value=V.value.filter(z=>z.taskId!==n),K(`ä¸Šä¼ å¤±è´¥: ${l.error||"æœªçŸ¥é”™è¯¯"}`,"error"))}else se(),V.value=V.value.filter(l=>l.taskId!==n)}catch(t){console.error("Failed to fetch progress:",t)}},500)},se=()=>{J.value&&(clearInterval(J.value),J.value=null)},Oe=n=>{if(!n.uploadProgress)return 0;const{current:t,total:l}=n.uploadProgress;return!l||l===0?0:t/l*100},We=n=>({waiting:"ç­‰å¾…ä¸­...",extracting:"æå–å†…å®¹...",cleaning:"æ¸…æ´—å†…å®¹...",parsing:"è§£æžæ–‡æ¡£...",chunking:"æ–‡æœ¬åˆ†å—...",embedding:"ç”Ÿæˆå‘é‡..."})[n]||n,ue=()=>{k.value=!1,_.value=[],O.value="",w.value="file",he()},Ge=n=>{S.push({name:"NativeDocumentDetail",params:{kbId:m.kbId,docId:n.doc_id}})},Qe=n=>{F.value=n,f.value=!0},Je=async()=>{if(F.value){U.value=!0;try{const n=await N.post("/api/kb/document/delete",{doc_id:F.value.doc_id,kb_id:m.kbId});n.data.status==="ok"?(K(d("documents.deleteSuccess")),f.value=!1,await pe(),x("refresh")):K(n.data.message||d("documents.deleteFailed"),"error")}catch(n){console.error("Failed to delete document:",n),K(d("documents.deleteFailed"),"error")}finally{U.value=!1}}},xe=n=>{const t=(n==null?void 0:n.toLowerCase())||"";return t.includes("pdf")?"mdi-file-pdf-box":t.includes("md")||t.includes("markdown")?"mdi-language-markdown":t.includes("txt")?"mdi-file-document-outline":t.includes("url")?"mdi-link-variant":"mdi-file"},Ze=n=>{const t=(n==null?void 0:n.toLowerCase())||"";return t.includes("pdf")?"error":t.includes("md")?"info":t.includes("txt")?"success":t.includes("url")?"primary":"grey"},Ve=n=>{if(!n)return"-";const t=["B","KB","MB","GB"];let l=n,v=0;for(;l>=1024&&v<t.length-1;)l/=1024,v++;return`${l.toFixed(2)} ${t[v]}`},Xe=n=>n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",Ye=async()=>{try{const n=await N.get("/api/config/provider/list",{params:{provider_type:"chat_completion"}});n.data.status==="ok"&&(re.value=n.data.data)}catch(n){console.error("Failed to load LLM providers:",n)}},we=async()=>{var n;b.value="loading";try{const t=await N.get("/api/config/abconf",{params:{id:"default"}});if(t.data.status==="ok"){const l=t.data.data.config,v=(n=l==null?void 0:l.provider_settings)==null?void 0:n.websearch_tavily_key;Array.isArray(v)&&v.length>0&&v.some(z=>z.trim()!=="")?b.value="configured":b.value="not_configured"}else b.value="error"}catch(t){console.warn("Failed to check Tavily key config:",t),b.value="error"}},ea=()=>{K("Tavily API Key é…ç½®æˆåŠŸ","success"),we()};return ge(()=>{pe(),Ye(),we()}),ta(()=>{se()}),(n,t)=>(C(),P("div",pa,[r("div",fa,[e(M,{"prepend-icon":"mdi-upload",color:"primary",variant:"elevated",onClick:t[0]||(t[0]=l=>k.value=!0)},{default:a(()=>[s(o(i(d)("documents.upload")),1)]),_:1}),e(A,{modelValue:$.value,"onUpdate:modelValue":t[1]||(t[1]=l=>$.value=l),"prepend-inner-icon":"mdi-magnify",placeholder:"æœç´¢æ–‡æ¡£...",variant:"outlined",density:"compact","hide-details":"",clearable:"",style:{"max-width":"300px"}},null,8,["modelValue","placeholder"])]),e(E,{elevation:"2"},{default:a(()=>[e(sa,{headers:Be,items:V.value,loading:I.value,search:$.value,"items-per-page":10},{"item.doc_name":a(({item:l})=>{var v,z;return[r("div",ga,[e(D,{color:Ze(l.file_type),class:"mr-2"},{default:a(()=>[s(o(xe(l.file_type)),1)]),_:2},1032,["color"]),r("div",ba,[r("span",ha,o(l.doc_name),1),l.uploading?(C(),P("div",ka,[r("div",ya,[s(o(We(((v=l.uploadProgress)==null?void 0:v.stage)||"waiting"))+" ",1),(z=l.uploadProgress)!=null&&z.current?(C(),P("span",xa," ("+o(l.uploadProgress.current)+" / "+o(l.uploadProgress.total)+") ",1)):H("",!0)]),e(Ue,{"model-value":Oe(l),color:"primary",height:"4",rounded:"",striped:""},null,8,["model-value"])])):H("",!0)])])]}),"item.file_size":a(({item:l})=>[s(o(Ve(l.file_size)),1)]),"item.created_at":a(({item:l})=>[s(o(Xe(l.created_at)),1)]),"item.actions":a(({item:l})=>[e(M,{icon:"mdi-eye",variant:"text",size:"small",color:"info",onClick:v=>Ge(l)},null,8,["onClick"]),e(M,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:v=>Qe(l)},null,8,["onClick"])]),"no-data":a(()=>[r("div",Va,[e(D,{size:"64",color:"grey-lighten-2"},{default:a(()=>[s("mdi-file-document-outline")]),_:1}),r("p",wa,o(i(d)("documents.empty")),1)])]),_:1},8,["items","loading","search"])]),_:1}),e(ce,{modelValue:k.value,"onUpdate:modelValue":t[17]||(t[17]=l=>k.value=l),"max-width":"650px",persistent:"",onAfterEnter:he},{default:a(()=>[e(E,null,{default:a(()=>[e(W,{class:"pa-4 d-flex align-center"},{default:a(()=>[r("span",za,o(i(d)("upload.title")),1),e(ee),e(M,{icon:"mdi-close",variant:"text",onClick:ue})]),_:1}),e(j),e(Ie,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=l=>w.value=l),grow:"",class:"mb-4"},{default:a(()=>[e(le,{value:"file"},{default:a(()=>[s(o(i(d)("upload.fileUpload")),1)]),_:1}),e(le,{value:"url"},{default:a(()=>[s(o(i(d)("upload.fromUrl"))+" ",1),e(oa,{color:"warning",content:i(d)("upload.beta"),inline:"",class:"ml-2"},null,8,["content"])]),_:1})]),_:1},8,["modelValue"]),e(G,{class:"pa-6 pt-2"},{default:a(()=>[e(De,{modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=l=>w.value=l)},{default:a(()=>[e(te,{value:"file"},{default:a(()=>[r("div",{class:na(["upload-dropzone",{dragover:p.value}]),onDrop:$e(Ee,["prevent"]),onDragover:t[3]||(t[3]=$e(l=>p.value=!0,["prevent"])),onDragleave:t[4]||(t[4]=l=>p.value=!1),onClick:t[5]||(t[5]=l=>{var v;return(v=R.value)==null?void 0:v.click()})},[e(D,{size:"64",color:"primary"},{default:a(()=>[s("mdi-cloud-upload")]),_:1}),r("p",Ca,o(i(d)("upload.dropzone")),1),r("p",Sa,o(i(d)("upload.supportedFormats"))+".txt, .md, .pdf, .docx, .xls, .xlsx",1),r("p",Ua,o(i(d)("upload.maxSize")),1),Ia,r("input",{ref_key:"fileInput",ref:R,type:"file",multiple:"",hidden:"",accept:".txt,.md,.pdf,.docx,.xls,.xlsx",onChange:Ae},null,544)],42,$a),_.value.length>0?(C(),P("div",Da,[r("div",Fa,[r("span",Pa,"å·²é€‰æ‹© "+o(_.value.length)+" ä¸ªæ–‡ä»¶",1),e(M,{variant:"text",size:"small",onClick:t[6]||(t[6]=l=>_.value=[])},{default:a(()=>[s("æ¸…ç©º")]),_:1})]),r("div",Ta,[(C(!0),P(Fe,null,Pe(_.value,(l,v)=>(C(),P("div",{key:v,class:"file-item pa-3 mb-2 rounded bg-surface-variant"},[r("div",Ma,[r("div",Ka,[e(D,null,{default:a(()=>[s(o(xe(l.name)),1)]),_:2},1024),r("div",null,[r("div",La,o(l.name),1),r("div",Ra,o(Ve(l.size)),1)])]),e(M,{icon:"mdi-close",variant:"text",size:"small",onClick:z=>Ne(v)},null,8,["onClick"])])]))),128))])])):H("",!0)]),_:1}),e(te,{value:"url",class:"pt-2"},{default:a(()=>[b.value==="not_configured"||b.value==="error"?(C(),P("div",Ba,[e(oe,{type:b.value==="error"?"error":"info",variant:"tonal",density:"compact"},{default:a(()=>[r("div",Aa,[r("span",null,o(b.value==="error"?"æ£€æŸ¥ç½‘é¡µæœç´¢é…ç½®å¤±è´¥":"ä½¿ç”¨æ­¤åŠŸèƒ½éœ€è¦é…ç½® Tavily Key"),1),e(M,{size:"small",variant:"flat",onClick:t[7]||(t[7]=l=>h.value=!0)},{default:a(()=>[s(" é…ç½® ")]),_:1})])]),_:1},8,["type"])])):H("",!0),e(A,{modelValue:O.value,"onUpdate:modelValue":t[8]||(t[8]=l=>O.value=l),label:i(d)("upload.urlPlaceholder"),variant:"outlined",clearable:"",disabled:b.value==="not_configured",autofocus:"",hint:i(d)("upload.urlHint",{supported:"HTML"}),"persistent-hint":""},null,8,["modelValue","label","disabled","hint"])]),_:1})]),_:1},8,["modelValue"]),w.value==="url"?(C(),P("div",Na,[r("div",Ea,[r("h3",ja,o(i(d)("upload.cleaningSettings")),1)]),e(Q,null,{default:a(()=>[e(T,{cols:"12",sm:"4"},{default:a(()=>[e(Te,{modelValue:g.value.enable_cleaning,"onUpdate:modelValue":t[10]||(t[10]=l=>g.value.enable_cleaning=l),label:i(d)("upload.enableCleaning"),color:"primary"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",sm:"8"},{default:a(()=>[e(fe,{modelValue:g.value.cleaning_provider_id,"onUpdate:modelValue":t[11]||(t[11]=l=>g.value.cleaning_provider_id=l),items:re.value,"item-title":"id","item-value":"id",label:i(d)("upload.cleaningProvider"),hint:i(d)("upload.cleaningProviderHint"),"persistent-hint":"",variant:"outlined",density:"compact",disabled:!g.value.enable_cleaning},null,8,["modelValue","items","label","hint","disabled"])]),_:1})]),_:1})])):H("",!0),r("div",qa,[r("div",Ha,[r("h3",Oa,o(i(d)("upload.chunkSettings")),1)]),e(Q,null,{default:a(()=>[e(T,{cols:"12",sm:"6"},{default:a(()=>{var l,v;return[e(A,{modelValue:g.value.chunk_size,"onUpdate:modelValue":t[12]||(t[12]=z=>g.value.chunk_size=z),modelModifiers:{number:!0},label:i(d)("upload.chunkSize"),hint:i(d)("upload.chunkSizeHint"),"persistent-hint":"",type:"number",variant:"outlined",density:"compact",placeholder:((v=(l=m.kb)==null?void 0:l.chunk_size)==null?void 0:v.toString())||"512"},null,8,["modelValue","label","hint","placeholder"])]}),_:1}),e(T,{cols:"12",sm:"6"},{default:a(()=>{var l,v;return[e(A,{modelValue:g.value.chunk_overlap,"onUpdate:modelValue":t[13]||(t[13]=z=>g.value.chunk_overlap=z),modelModifiers:{number:!0},label:i(d)("upload.chunkOverlap"),hint:i(d)("upload.chunkOverlapHint"),"persistent-hint":"",type:"number",variant:"outlined",density:"compact",placeholder:((v=(l=m.kb)==null?void 0:l.chunk_overlap)==null?void 0:v.toString())||"50"},null,8,["modelValue","label","hint","placeholder"])]}),_:1})]),_:1})]),r("div",Wa,[r("h3",Ga,o(i(d)("upload.batchSettings")),1),e(Q,null,{default:a(()=>[e(T,{cols:"12",sm:"4"},{default:a(()=>[e(A,{modelValue:g.value.batch_size,"onUpdate:modelValue":t[14]||(t[14]=l=>g.value.batch_size=l),modelModifiers:{number:!0},label:i(d)("upload.batchSize"),hint:"æ¯æ‰¹å¤„ç†çš„æ–‡æœ¬æ•°é‡","persistent-hint":"",type:"number",variant:"outlined",density:"compact"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",sm:"4"},{default:a(()=>[e(A,{modelValue:g.value.tasks_limit,"onUpdate:modelValue":t[15]||(t[15]=l=>g.value.tasks_limit=l),modelModifiers:{number:!0},label:i(d)("upload.tasksLimit"),hint:"å¹¶å‘ä»»åŠ¡æ•°é‡é™åˆ¶","persistent-hint":"",type:"number",variant:"outlined",density:"compact"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",sm:"4"},{default:a(()=>[e(A,{modelValue:g.value.max_retries,"onUpdate:modelValue":t[16]||(t[16]=l=>g.value.max_retries=l),modelModifiers:{number:!0},label:i(d)("upload.maxRetries"),hint:"å¤±è´¥æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°","persistent-hint":"",type:"number",variant:"outlined",density:"compact"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),e(j),e(ie,{class:"pa-4"},{default:a(()=>[e(ee),e(M,{variant:"text",onClick:ue,disabled:c.value},{default:a(()=>[s(o(i(d)("upload.cancel")),1)]),_:1},8,["disabled"]),e(M,{color:"primary",variant:"elevated",onClick:je,loading:c.value,disabled:Re.value},{default:a(()=>[s(o(i(d)("upload.submit")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ce,{modelValue:f.value,"onUpdate:modelValue":t[19]||(t[19]=l=>f.value=l),"max-width":"450px"},{default:a(()=>[e(E,null,{default:a(()=>[e(W,{class:"pa-4 text-h6"},{default:a(()=>[s(o(i(d)("documents.delete")),1)]),_:1}),e(j),e(G,{class:"pa-6"},{default:a(()=>{var l;return[r("p",null,o(i(d)("documents.deleteConfirm",{name:((l=F.value)==null?void 0:l.doc_name)||""})),1),e(oe,{type:"error",variant:"tonal",density:"compact",class:"mt-4"},{default:a(()=>[s(o(i(d)("documents.deleteWarning")),1)]),_:1})]}),_:1}),e(j),e(ie,{class:"pa-4"},{default:a(()=>[e(ee),e(M,{variant:"text",onClick:t[18]||(t[18]=l=>f.value=!1)},{default:a(()=>[s("å–æ¶ˆ")]),_:1}),e(M,{color:"error",variant:"elevated",onClick:Je,loading:U.value},{default:a(()=>[s(" åˆ é™¤ ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(me,{modelValue:y.value.show,"onUpdate:modelValue":t[20]||(t[20]=l=>y.value.show=l),color:y.value.color},{default:a(()=>[s(o(y.value.text),1)]),_:1},8,["modelValue","color"]),e(ma,{modelValue:h.value,"onUpdate:modelValue":t[21]||(t[21]=l=>h.value=l),onSuccess:ea},null,8,["modelValue"])]))}});const Ja=_e(Qa,[["__scopeId","data-v-aaf7fd1a"]]),Za={class:"retrieval-tab"},Xa={key:0,class:"mt-2"},Ya={class:"d-flex align-center justify-center fill-height"},el={class:"text-subtitle-2 mb-3"},al={class:"text-caption"},ll={class:"d-flex justify-end mb-4"},tl={key:0,class:"results-section"},sl={class:"d-flex align-center mb-4"},ol={class:"text-h6"},nl={key:0,class:"results-list"},il={class:"text-subtitle-1"},dl={class:"ml-4"},rl={class:"content-box"},ul={key:1,class:"text-center py-12"},cl={class:"text-h6 mt-4 text-medium-emphasis"},vl={class:"text-body-2 text-medium-emphasis"},ml=de({__name:"RetrievalTab",props:{kbId:{},kbName:{}},setup(L){const x=L,{tm:m}=ve("features/knowledge-base/detail"),d=u(!1),S=u(""),I=u(5),c=u(!1),U=u([]),V=u(!1),$=u(null),k=u({show:!1,text:"",color:"success"}),f=(p,R="success")=>{k.value.text=p,k.value.color=R,k.value.show=!0},_=async()=>{if(!S.value||S.value.trim()===""){f(m("retrieval.queryRequired"),"warning");return}d.value=!0,V.value=!1,$.value=null;try{const p=await N.post("/api/kb/retrieve",{query:S.value,kb_names:[x.kbName],top_k:I.value,debug:c.value});p.data.status==="ok"?(U.value=p.data.data.results||[],V.value=!0,c.value&&p.data.data.visualization&&($.value=p.data.data.visualization),f(m("retrieval.searchSuccess",{count:U.value.length}))):f(p.data.message||m("retrieval.searchFailed"),"error")}catch(p){console.error("Retrieval failed:",p),f(m("retrieval.searchFailed"),"error")}finally{d.value=!1}},F=p=>p>=.8?"success":p>=.6?"info":p>=.4?"warning":"error";return(p,R)=>(C(),P("div",Za,[e(E,{elevation:"2"},{default:a(()=>[e(W,{class:"pa-4 pb-0"},{default:a(()=>[s(o(i(m)("retrieval.title")),1)]),_:1}),e(ia,{class:"pb-4 pt-2"},{default:a(()=>[s(o(i(m)("retrieval.subtitle")),1)]),_:1}),e(j),d.value?(C(),ne(Ue,{key:0,indeterminate:"",color:"primary",height:"2"})):H("",!0),e(G,{class:"pa-6"},{default:a(()=>[e(Q,{class:"mb-4"},{default:a(()=>[e(T,{cols:"12",md:"8"},{default:a(()=>[e(da,{modelValue:S.value,"onUpdate:modelValue":R[0]||(R[0]=w=>S.value=w),label:i(m)("retrieval.query"),placeholder:i(m)("retrieval.queryPlaceholder"),variant:"outlined",rows:"3","auto-grow":"",clearable:""},null,8,["modelValue","label","placeholder"]),$.value?(C(),P("div",Xa,[e(E,{variant:"outlined"},{default:a(()=>[e(ra,{src:`data:image/png;base64,${$.value}`,alt:i(m)("retrieval.tsneVisualization"),cover:""},{placeholder:a(()=>[r("div",Ya,[e(Le,{indeterminate:"",color:"primary"})])]),_:1},8,["src","alt"])]),_:1})])):H("",!0)]),_:1}),e(T,{cols:"12",md:"4"},{default:a(()=>[e(E,{variant:"outlined",class:"pa-4"},{default:a(()=>[r("h4",el,o(i(m)("retrieval.settings")),1),e(A,{modelValue:I.value,"onUpdate:modelValue":R[1]||(R[1]=w=>I.value=w),modelModifiers:{number:!0},label:i(m)("retrieval.topK"),hint:i(m)("retrieval.topKHint"),type:"number",variant:"outlined",density:"compact","persistent-hint":"",class:"mb-3"},null,8,["modelValue","label","hint"]),e(Te,{modelValue:c.value,"onUpdate:modelValue":R[2]||(R[2]=w=>c.value=w),label:i(m)("retrieval.debugMode"),color:"primary",density:"compact","hide-details":""},{label:a(()=>[r("span",al,[e(D,{size:"small",class:"mr-1"},{default:a(()=>[s("mdi-bug")]),_:1}),s(" Debug (t-SNE) ")])]),_:1},8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),r("div",ll,[e(M,{"prepend-icon":"mdi-magnify",color:"primary",variant:"elevated",onClick:_,loading:d.value,disabled:!S.value||S.value.trim()===""},{default:a(()=>[s(o(d.value?i(m)("retrieval.searching"):i(m)("retrieval.search")),1)]),_:1},8,["loading","disabled"])]),V.value?(C(),P("div",tl,[e(j,{class:"mb-4"}),r("div",sl,[r("h3",ol,o(i(m)("retrieval.results")),1),e(ae,{class:"ml-3",color:"primary",variant:"tonal",size:"small"},{default:a(()=>[s(o(U.value.length)+" "+o(i(m)("retrieval.results")),1)]),_:1})]),U.value.length>0?(C(),P("div",nl,[(C(!0),P(Fe,null,Pe(U.value,(w,O)=>(C(),ne(E,{key:w.chunk_id,variant:"outlined",class:"mb-4"},{default:a(()=>[e(W,{class:"d-flex align-center pa-2"},{default:a(()=>[e(ae,{size:"x-small",color:"primary",class:"mr-2"},{default:a(()=>[s(" #"+o(O+1),1)]),_:2},1024),r("span",il,o(i(m)("retrieval.chunk",{index:w.chunk_index})),1),r("div",dl,[e(ae,{size:"x-small",variant:"tonal",class:"mr-2"},{default:a(()=>[e(D,{start:"",size:"small"},{default:a(()=>[s("mdi-file-document")]),_:1}),s(" "+o(w.doc_name),1)]),_:2},1024),e(ae,{size:"x-small",variant:"tonal"},{default:a(()=>[e(D,{start:"",size:"small"},{default:a(()=>[s("mdi-text")]),_:1}),s(" "+o(i(m)("retrieval.charCount",{count:w.char_count})),1)]),_:2},1024)]),e(ee),e(ae,{size:"x-small",color:F(w.score)},{default:a(()=>[s(o(i(m)("retrieval.score"))+": "+o(w.score.toFixed(4)),1)]),_:2},1032,["color"])]),_:2},1024),e(j),e(G,{class:"pa-4"},{default:a(()=>[r("div",rl,o(w.content),1)]),_:2},1024)]),_:2},1024))),128))])):(C(),P("div",ul,[e(D,{size:"80",color:"grey-lighten-2"},{default:a(()=>[s("mdi-text-box-search-outline")]),_:1}),r("p",cl,o(i(m)("retrieval.noResults")),1),r("p",vl,o(i(m)("retrieval.tryDifferentQuery")),1)]))])):H("",!0)]),_:1})]),_:1}),e(me,{modelValue:k.value.show,"onUpdate:modelValue":R[3]||(R[3]=w=>k.value.show=w),color:k.value.color},{default:a(()=>[s(o(k.value.text),1)]),_:1},8,["modelValue","color"])]))}});const _l=_e(ml,[["__scopeId","data-v-927625c3"]]),be=L=>(Me("data-v-ccfc0465"),L=L(),Ke(),L),pl={class:"settings-tab"},fl={class:"text-h6 mb-4"},gl={class:"text-h6 mb-4 mt-6"},bl={class:"text-h6 mb-4 mt-6"},hl=be(()=>r("strong",null,"æ³¨æ„:",-1)),kl=be(()=>r("strong",null,"è­¦å‘Š:",-1)),yl=be(()=>r("ul",{class:"text-body-2"},[r("li",null,"çŽ°æœ‰çš„å‘é‡æ•°æ®å°†å¤±æ•ˆ"),r("li",null,"æ£€ç´¢åŠŸèƒ½å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ"),r("li",null,"å»ºè®®åˆ é™¤çŽ°æœ‰æ–‡æ¡£åŽé‡æ–°ä¸Šä¼ "),r("li",null,"ä¸åŒåµŒå…¥æ¨¡åž‹ç”Ÿæˆçš„å‘é‡ä¸å…¼å®¹")],-1)),xl={class:"mt-4 text-body-2"},Vl=de({__name:"SettingsTab",props:{kb:{}},emits:["updated"],setup(L,{emit:x}){const m=L,{tm:d}=ve("features/knowledge-base/detail"),S=u(!1),I=u(),c=u([]),U=u([]),V=u(""),$=u(!1),k=u(!1),f=u(""),_=u({show:!1,text:"",color:"success"}),F=(b,h="success")=>{_.value.text=b,_.value.color=h,_.value.show=!0},p=u({chunk_size:512,chunk_overlap:50,top_k_dense:50,top_k_sparse:50,embedding_provider_id:"",rerank_provider_id:""});Se(()=>m.kb,b=>{b&&(p.value={chunk_size:b.chunk_size||512,chunk_overlap:b.chunk_overlap||50,top_k_dense:b.top_k_dense||50,top_k_sparse:b.top_k_sparse||50,embedding_provider_id:b.embedding_provider_id||"",rerank_provider_id:b.rerank_provider_id||""},V.value=b.embedding_provider_id||"")},{immediate:!0});const R=async()=>{try{const b=await N.get("/api/config/provider/list",{params:{provider_type:"embedding,rerank"}});b.data.status==="ok"&&(c.value=b.data.data.filter(h=>h.provider_type==="embedding"),U.value=b.data.data.filter(h=>h.provider_type==="rerank"))}catch(b){console.error("Failed to load providers:",b)}},w=b=>{b&&b!==V.value?($.value=!0,f.value=b,k.value=!0):$.value=!1},O=()=>{p.value.embedding_provider_id=f.value,k.value=!1,$.value=!0},re=()=>{p.value.embedding_provider_id=V.value,k.value=!1,$.value=!1,f.value=""},J=async()=>{const{valid:b}=await I.value.validate();if(b){S.value=!0;try{const h=await N.post("/api/kb/update",{kb_id:m.kb.kb_id,chunk_size:p.value.chunk_size,chunk_overlap:p.value.chunk_overlap,top_k_dense:p.value.top_k_dense,top_k_sparse:p.value.top_k_sparse,rerank_provider_id:p.value.rerank_provider_id});h.data.status==="ok"?(F(d("settings.saveSuccess")),x("updated")):F(h.data.message||d("settings.saveFailed"),"error")}catch(h){console.error("Failed to save settings:",h),F(d("settings.saveFailed"),"error")}finally{S.value=!1}}};return ge(()=>{R()}),(b,h)=>(C(),P("div",pl,[e(E,{elevation:"2"},{default:a(()=>[e(W,{class:"pa-4"},{default:a(()=>[s(o(i(d)("settings.title")),1)]),_:1}),e(j),e(G,{class:"pa-6"},{default:a(()=>[e(ua,{ref_key:"formRef",ref:I},{default:a(()=>[r("h3",fl,o(i(d)("settings.basic")),1),e(Q,null,{default:a(()=>[e(T,{cols:"12",md:"6"},{default:a(()=>[e(A,{modelValue:p.value.chunk_size,"onUpdate:modelValue":h[0]||(h[0]=y=>p.value.chunk_size=y),modelModifiers:{number:!0},label:i(d)("settings.chunkSize"),type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",md:"6"},{default:a(()=>[e(A,{modelValue:p.value.chunk_overlap,"onUpdate:modelValue":h[1]||(h[1]=y=>p.value.chunk_overlap=y),modelModifiers:{number:!0},label:i(d)("settings.chunkOverlap"),type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue","label"])]),_:1})]),_:1}),r("h3",gl,o(i(d)("settings.retrieval")),1),e(Q,null,{default:a(()=>[e(T,{cols:"12",md:"6"},{default:a(()=>[e(A,{modelValue:p.value.top_k_dense,"onUpdate:modelValue":h[2]||(h[2]=y=>p.value.top_k_dense=y),modelModifiers:{number:!0},label:i(d)("settings.topKDense"),type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",md:"6"},{default:a(()=>[e(A,{modelValue:p.value.top_k_sparse,"onUpdate:modelValue":h[3]||(h[3]=y=>p.value.top_k_sparse=y),modelModifiers:{number:!0},label:i(d)("settings.topKSparse"),type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue","label"])]),_:1})]),_:1}),r("h3",bl,o(i(d)("settings.embeddingProvider")),1),e(Q,null,{default:a(()=>[e(T,{cols:"12",md:"6"},{default:a(()=>[e(fe,{modelValue:p.value.embedding_provider_id,"onUpdate:modelValue":[h[4]||(h[4]=y=>p.value.embedding_provider_id=y),w],items:c.value,"item-title":y=>y.embedding_model||y.id,"item-value":"id",label:i(d)("settings.embeddingProvider"),variant:"outlined",density:"comfortable",disabled:!0},null,8,["modelValue","items","item-title","label"])]),_:1}),e(T,{cols:"12",md:"6"},{default:a(()=>[e(fe,{modelValue:p.value.rerank_provider_id,"onUpdate:modelValue":h[5]||(h[5]=y=>p.value.rerank_provider_id=y),items:U.value,"item-title":y=>y.rerank_model||y.id,"item-value":"id",label:i(d)("settings.rerankProvider"),variant:"outlined",density:"comfortable",clearable:""},null,8,["modelValue","items","item-title","label"])]),_:1})]),_:1}),e(oe,{type:"info",variant:"tonal",class:"mt-4"},{default:a(()=>[s(o(i(d)("settings.tips")),1)]),_:1}),$.value?(C(),ne(oe,{key:0,type:"warning",variant:"tonal",class:"mt-4"},{default:a(()=>[hl,s(" ä¿®æ”¹åµŒå…¥æ¨¡åž‹ä¼šå¯¼è‡´çŽ°æœ‰çš„å‘é‡æ•°æ®å¤±æ•ˆ,å»ºè®®é‡æ–°ä¸Šä¼ æ–‡æ¡£ã€‚ä¸åŒçš„åµŒå…¥æ¨¡åž‹ç”Ÿæˆçš„å‘é‡ä¸å…¼å®¹,å¯èƒ½å¯¼è‡´æ£€ç´¢ç»“æžœä¸å‡†ç¡®ã€‚ ")]),_:1})):H("",!0)]),_:1},512)]),_:1}),e(j),e(ie,{class:"pa-4"},{default:a(()=>[e(ee),e(M,{color:"primary",variant:"elevated","prepend-icon":"mdi-content-save",onClick:J,loading:S.value},{default:a(()=>[s(o(i(d)("settings.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1}),e(me,{modelValue:_.value.show,"onUpdate:modelValue":h[6]||(h[6]=y=>_.value.show=y),color:_.value.color},{default:a(()=>[s(o(_.value.text),1)]),_:1},8,["modelValue","color"]),e(ce,{modelValue:k.value,"onUpdate:modelValue":h[7]||(h[7]=y=>k.value=y),"max-width":"500px",persistent:""},{default:a(()=>[e(E,null,{default:a(()=>[e(W,{class:"bg-warning text-white"},{default:a(()=>[e(D,{class:"mr-2"},{default:a(()=>[s("mdi-alert")]),_:1}),s(" ç¡®è®¤ä¿®æ”¹åµŒå…¥æ¨¡åž‹ ")]),_:1}),e(G,{class:"pa-6"},{default:a(()=>[e(oe,{type:"warning",variant:"tonal",class:"mb-4"},{default:a(()=>[kl,s(" ä¿®æ”¹åµŒå…¥æ¨¡åž‹å°†å¯¼è‡´ä»¥ä¸‹å½±å“: ")]),_:1}),yl,r("div",xl,[s(" æ‚¨ç¡®å®šè¦å°†åµŒå…¥æ¨¡åž‹ä»Ž "),r("strong",null,o(V.value),1),s(" ä¿®æ”¹ä¸º "),r("strong",null,o(f.value),1),s(" å—? ")])]),_:1}),e(ie,{class:"pa-4"},{default:a(()=>[e(ee),e(M,{variant:"text",onClick:re},{default:a(()=>[s(" å–æ¶ˆ ")]),_:1}),e(M,{color:"warning",variant:"elevated",onClick:O},{default:a(()=>[s(" ç¡®è®¤ä¿®æ”¹ ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});const wl=_e(Vl,[["__scopeId","data-v-ccfc0465"]]),zl={class:"kb-detail-page"},$l={class:"page-header"},Cl={class:"header-content"},Sl={class:"kb-title"},Ul={class:"kb-emoji"},Il={class:"text-h4"},Dl={key:0,class:"text-subtitle-1 text-medium-emphasis mt-2"},Fl={key:0,class:"loading-container"},Pl={key:1,class:"kb-content"},Tl={class:"stat-box"},Ml={class:"stat-value"},Kl={class:"stat-label"},Ll={class:"stat-box"},Rl={class:"stat-value"},Bl={class:"stat-label"},Al=de({__name:"KBDetail",setup(L){const{tm:x}=ve("features/knowledge-base/detail"),m=ca(),d=u(m.params.kbId),S=u(!0),I=u("overview"),c=u({}),U=u({show:!1,text:"",color:"success"}),V=(f,_="success")=>{U.value.text=f,U.value.color=_,U.value.show=!0},$=async()=>{S.value=!0;try{const f=await N.get("/api/kb/get",{params:{kb_id:d.value}});f.data.status==="ok"?c.value=f.data.data:V(f.data.message||"åŠ è½½å¤±è´¥","error")}catch(f){console.error("Failed to load knowledge base:",f),V("åŠ è½½çŸ¥è¯†åº“è¯¦æƒ…å¤±è´¥","error")}finally{S.value=!1}},k=f=>f?new Date(f).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return ge(()=>{$()}),(f,_)=>(C(),P("div",zl,[r("div",$l,[e(M,{icon:"mdi-arrow-left",variant:"text",onClick:_[0]||(_[0]=F=>f.$router.push({name:"NativeKBList"}))}),r("div",Cl,[r("div",Sl,[r("span",Ul,o(c.value.emoji||"ðŸ“š"),1),r("h1",Il,o(c.value.kb_name),1)]),c.value.description?(C(),P("p",Dl,o(c.value.description),1)):H("",!0)])]),S.value?(C(),P("div",Fl,[e(Le,{indeterminate:"",color:"primary",size:"64"})])):(C(),P("div",Pl,[e(Ie,{modelValue:I.value,"onUpdate:modelValue":_[1]||(_[1]=F=>I.value=F),class:"mb-6",color:"primary"},{default:a(()=>[e(le,{value:"overview"},{default:a(()=>[e(D,{start:""},{default:a(()=>[s("mdi-information-outline")]),_:1}),s(" "+o(i(x)("tabs.overview")),1)]),_:1}),e(le,{value:"documents"},{default:a(()=>[e(D,{start:""},{default:a(()=>[s("mdi-file-document-multiple")]),_:1}),s(" "+o(i(x)("tabs.documents"))+" ",1),e(ae,{class:"ml-2",size:"small",variant:"tonal"},{default:a(()=>[s(o(c.value.doc_count||0),1)]),_:1})]),_:1}),e(le,{value:"retrieval"},{default:a(()=>[e(D,{start:""},{default:a(()=>[s("mdi-magnify")]),_:1}),s(" "+o(i(x)("tabs.retrieval")),1)]),_:1}),e(le,{value:"settings"},{default:a(()=>[e(D,{start:""},{default:a(()=>[s("mdi-cog")]),_:1}),s(" "+o(i(x)("tabs.settings")),1)]),_:1})]),_:1},8,["modelValue"]),e(De,{modelValue:I.value,"onUpdate:modelValue":_[2]||(_[2]=F=>I.value=F),style:{padding:"8px"}},{default:a(()=>[e(te,{value:"overview"},{default:a(()=>[e(Q,null,{default:a(()=>[e(T,{cols:"12",md:"6"},{default:a(()=>[e(E,{elevation:"2"},{default:a(()=>[e(W,null,{default:a(()=>[s(o(i(x)("overview.title")),1)]),_:1}),e(j),e(G,null,{default:a(()=>[e(Ce,{density:"comfortable"},{default:a(()=>[e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-label")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.name")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(c.value.kb_name),1)]),_:1})]),_:1}),c.value.description?(C(),ne(Z,{key:0},{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-text")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.description")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(c.value.description),1)]),_:1})]),_:1})):H("",!0),e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-emoticon")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.emoji")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(c.value.emoji||"ðŸ“š"),1)]),_:1})]),_:1}),e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-calendar-plus")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.createdAt")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(k(c.value.created_at)),1)]),_:1})]),_:1}),e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-calendar-edit")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.updatedAt")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(k(c.value.updated_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{cols:"12",md:"6"},{default:a(()=>[e(E,{elevation:"2",class:"mb-4"},{default:a(()=>[e(W,null,{default:a(()=>[s(o(i(x)("overview.stats")),1)]),_:1}),e(j),e(G,null,{default:a(()=>[e(Q,null,{default:a(()=>[e(T,{cols:"6"},{default:a(()=>[r("div",Tl,[e(D,{size:"48",color:"primary"},{default:a(()=>[s("mdi-file-document")]),_:1}),r("div",Ml,o(c.value.doc_count||0),1),r("div",Kl,o(i(x)("overview.docCount")),1)])]),_:1}),e(T,{cols:"6"},{default:a(()=>[r("div",Ll,[e(D,{size:"48",color:"secondary"},{default:a(()=>[s("mdi-text-box")]),_:1}),r("div",Rl,o(c.value.chunk_count||0),1),r("div",Bl,o(i(x)("overview.chunkCount")),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{elevation:"2"},{default:a(()=>[e(W,null,{default:a(()=>[s(o(i(x)("overview.embeddingModel")),1)]),_:1}),e(j),e(G,null,{default:a(()=>[e(Ce,{density:"comfortable"},{default:a(()=>[e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-vector-point")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.embeddingModel")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(c.value.embedding_provider_id||i(x)("overview.notSet")),1)]),_:1})]),_:1}),e(Z,null,{prepend:a(()=>[e(D,null,{default:a(()=>[s("mdi-sort-ascending")]),_:1})]),default:a(()=>[e(X,null,{default:a(()=>[s(o(i(x)("overview.rerankModel")),1)]),_:1}),e(Y,null,{default:a(()=>[s(o(c.value.rerank_provider_id||i(x)("overview.notSet")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(te,{value:"documents"},{default:a(()=>[e(Ja,{"kb-id":d.value,kb:c.value,onRefresh:$},null,8,["kb-id","kb"])]),_:1}),e(te,{value:"retrieval"},{default:a(()=>[e(_l,{"kb-id":d.value,"kb-name":c.value.kb_name},null,8,["kb-id","kb-name"])]),_:1}),e(te,{value:"settings"},{default:a(()=>[e(wl,{kb:c.value,onUpdated:$},null,8,["kb"])]),_:1})]),_:1},8,["modelValue"])])),e(me,{modelValue:U.value.show,"onUpdate:modelValue":_[3]||(_[3]=F=>U.value.show=F),color:U.value.color},{default:a(()=>[s(o(U.value.text),1)]),_:1},8,["modelValue","color"])]))}});const jl=_e(Al,[["__scopeId","data-v-882e750f"]]);export{jl as default};
