import{u as n,a5 as m,o as l,a as c,w as e,b as s,N as h,e as u,t as T,P as d,T as f,M as w,a2 as p}from"./index-77b120c5.js";import{u as S}from"./common-6d6e5a4f.js";import{_ as g}from"./_plugin-vue_export-helper-c27b6911.js";const _={name:"WaitingForRestart",setup(){const{t:i}=n();return{t:i}},data(){return{visible:!1,startTime:-1,newStartTime:-1,status:"",cnt:0}},methods:{async check(){this.newStartTime=-1,this.startTime=S().getStartTime(),this.visible=!0,this.status="",console.log("start wfr"),setTimeout(()=>{this.timeoutInternal()},1e3)},timeoutInternal(){console.log("wfr: timeoutInternal",this.newStartTime,this.startTime),this.newStartTime===-1&&this.cnt<60&&this.visible?(this.checkStartTime(),this.cnt++,setTimeout(()=>{this.timeoutInternal()},1e3)):(this.cnt==10&&(this.status=this.t("core.common.restart.maxRetriesReached")),this.cnt=0,setTimeout(()=>{this.visible=!1},1e3))},async checkStartTime(){let t=(await m.get("/api/stat/start-time",{timeout:3e3})).data.data.start_time;return console.log("wfr: checkStartTime",this.newStartTime,this.startTime),this.newStartTime!==this.startTime&&(this.newStartTime=t,console.log("wfr: restarted"),this.visible=!1,window.location.reload()),this.newStartTime}}};function V(i,t,x,r,a,b){return l(),c(p,{modelValue:a.visible,"onUpdate:modelValue":t[0]||(t[0]=o=>a.visible=o),persistent:"","max-width":"400"},{default:e(()=>[s(w,null,{default:e(()=>[s(h,null,{default:e(()=>[u(T(r.t("core.common.restart.waiting")),1)]),_:1}),s(d,null,{default:e(()=>[s(f,{indeterminate:"",color:"primary"})]),_:1})]),_:1})]),_:1},8,["modelValue"])}const I=g(_,[["render",V]]);export{I as W};
